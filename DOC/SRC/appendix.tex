\section{Notational Conventions}

\setglossarypreamble[main]{\label{tab:symbols}}

\printglossary[type=main, title={Base symbols}]

\subsection{Symbol Decorations}
\label{tab:decorations}

\begin{longtable*}{l >{\RaggedRight}p{0.8\textwidth}}
  \toprule
  \textbf{Notation} & \textbf{Description} \\
  \midrule
  \endhead
  $p_{0}$ & equilibrium $p$ \\
  $\delta p$ & perturbation of $p$ \\
  $p_{n}$ & \textsc{Fourier} coefficient of perturbation of $p$ with toroidal mode number $n$ \\
  $p_{m n}$ & \textsc{Fourier} coefficient of perturbation of $p$ with poloidal mode number $m$ and toroidal mode number $n$ \\
  $p^{(k)}$ & $k$-th summand in series expansion of perturbed $p$ / $k$-th degree of freedom of $p$ in a particular loop \\
  $p^{[k]}$ & $k$-th partial sum in series expansion of perturbed $p$ \\
  \midrule
  $\vec{J}^{\pol}$ & poloidal component of $\vec{J}$ \\
  $\vec{J}^{\tor}$ & toroidal component of $\vec{J}$ \\
  $\vec{J}^{\parallel}$ & component of $\vec{J}$ parallel to $\vec{B}_{0}$ \\
  $\vec{J}^{\perp}$ & component of $\vec{J}$ perpendicular to $\vec{B}_{0}$ \\
  $J^{u}$ & contravariant component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $J_{u}$ & covariant component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $J_{(u)}$ & physical component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $\hat{\vec{n}}$ & unit vector in direction of $\vec{n}$ \\
  \midrule
  $\vec{B} (\vec{r}^{(k)})$ & $\vec{B}$ evaluated at node with index $k$ \\
  $\vec{B} (\Gamma_{e}^{(k)})$ & $\vec{B}$ evaluated at midpoint of edge $e$ of triangle $k$ \\
  $\vec{B} (\Omega^{(k)})$ & $\vec{B}$ evaluated at weighted centroid of triangle $k$ \\
  \midrule
  $\langle \cdot \rangle$ & flux surface average \\
  $[ \cdot ]_{m n}$ & \textsc{Fourier} transform with poloidal and toroidal mode numbers \\
  \bottomrule
\end{longtable*}

\section{Arnoldi Iterations}
\label{app:Arnoldi}

For an $N \times N$ matrix $\hat{K}$, the \textsc{Arnoldi} algorithm gives the largest $n_{r}$ \textsc{Ritz} eigenvalues $\lambda_{k}$  and the associated eigenvectors $\vec{v}_{k}$ which span the \textsc{Krylov} subspace of $\hat{K}$. To accomplish this, $\hat{K}$ is repeatedly applied to an arbitrary initial vector $\vec{q}_{1}$. In each iteration step, the next \textsc{Arnoldi} vector $\vec{q}_{k}$ is generated and orthonormalized with respect to the previously generated vectors by \textsc{Gram}-\textsc{Schmidt} orthogonalization. Also, entries of an upper \textsc{Hessenberg} matrix $\hat{H}$ are constructed, as outlined in \cref{alg:arnoldi}.
\begin{algorithm}
  \caption{\textsc{Arnoldi} iterations}
  \label{alg:arnoldi}
  \begin{algorithmic}[1]
    \State{$\vec{q}_{1} \gets \frac{\vec{q}_{1}}{\norm{\vec{q}_{1}}}$}
    \For{$k = 2, 3, \dotsc, n_{r}$}
      \State{$\vec{q}_{k} \gets \hat{K} \vec{q}_{k-1}$}
      \For{$j = 1, 2, \dotsc, k-1$}
        \State{$H_{j, k-1} \gets \vec{q}_{j}^{\dagger} \vec{q}_{k}$}
        \State{$\vec{q}_{k} \gets \vec{q}_{k} - H_{j, k-1} \vec{q}_{j}$}
      \EndFor
      \State{$H_{k, k-1} \gets \norm{\vec{q}_{k}}$}
      \State{$\vec{q}_{k} \gets \frac{\vec{q}_{k}}{H_{k, k-1}}$}
    \EndFor
  \end{algorithmic}
\end{algorithm}
Grouping together the $\vec{q}_{k}$ vectors in an $N \times n_{r}$ matrix $\hat{Q}$, an approximation of $\hat{K}$ can be written out as
\begin{gather}
  \hat{K} \approx \hat{Q} \hat{H} \hat{Q}^{\dagger}.
\end{gather}
Diagonalization of $\hat{H}$ via the LAPACK routine \texttt{zhseqr} yields the \textsc{Ritz} eigenvalues $\lambda_{k}$ and application of $\hat{Q}$ on the eigenvectors of $\hat{H}$ obtained via \texttt{zhsein} gives the eigenvectors $\vec{v}_{k}$ associated with $\hat{K}$.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../magdif"
%%% End: 
