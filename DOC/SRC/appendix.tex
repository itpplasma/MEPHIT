\section{List of symbols}

\begin{longtable}{l >{\RaggedRight}p{0.8\textwidth}}
  \caption{Base symbols} \\
  \toprule
  \textbf{Notation} & \textbf{Description} \\
  \midrule
  \endhead
  \label{tab:symbols}%
  $\hat{A}$ & matrix applied to precondition iterations \\
  $\vec{A}$ & magnetic vector potential \\
  $\vec{B}$ & magnetic field strength, measured in Gauss \\
  $\Bplas$ & perturbation field from \emph{p}lasma current \\
  $\Bvac$ & perturbation field in \emph{v}acuum (from external coils) \\
  $C$ & arbitrary constant (of integration) \\
  $c$ & speed of light in centimetres per second \\
  $\e$ & \textsc{Euler}'s constant, base of natural logarithm \\
  $\vec{e}$ & basis vector \\
  $g$ & metric determinant \\
  $\vec{h}_{0}$ & unit vector of $\vec{B}_{0}$ \\
  $\hat{I}$ & unit matrix \\
  $I$ & electric current \\
  $I_{\text{c}}$ & electric current produced by RMP \emph{c}oils \\
  $\im$ & imaginary unit, $\im^{2} = -1$ \\
  $\vec{J}$ & electric current density, measured in statampere \\
  $\hat{K}$ & combined linear operator $\hat{M} \hat{P}$ / stiffness matrix \\
  $k_{\text{B}}$ & \textsc{Boltzmann} constant \\
  $\vec{l}$ & edge vector in counter-clockwise direction \\
  $l$ & length of edge \\
  $\hat{M}$ & linear operator representing computation of the magnetic field from the currents via \textsc{AmpÃ¨re}'s equation \\
  $m$ & poloidal mode number \\
  $n$ & toroidal mode number / density of particles \\
  $\vec{n}$ & outward pointing normal vector \\
  $N$ & dimension of system of linear equations \\
  $\hat{P}$ & linear operator representing computation of the currents from the magnetic field \\
  $p$ & pressure, measured in dyne per square centimetre \\
  $q$ & safety factor \\
  $R$ & radial coordinate in cylindrical coordinates \\
  $R_{0}$ & major radius of the tokamak \\
  $r$ & arbitrary point in a domain $\Omega$ \\
  $S$ & area in poloidal cross-section \\
  $\vec{s}$ & source term in systems of linear equations \\
  $T$ & temperature \\
  $Z$ & axial coordinate in cylindrical coordinates \\
  $\Gamma$ & border of a domain $\Omega$, e.g. edge of a triangle \\
  $\delta_{ij}$ & \textsc{Kronecker} delta \\
  $\lambda$ & eigenvalue \\
  $\theta$ & poloidal angle \\
  $\rho$ & flux surface label \\
  $\phi$ & toroidal angle \\
  $\Psi$ & magnetic flux \\
  $\psi$ & flux surface label \\
  $\Omega$ & domain of computation, e.g. a triangle \\
  \bottomrule
\end{longtable}

\begin{longtable}{l >{\RaggedRight}p{0.8\textwidth}}
  \caption{Symbol decorations} \\
  \toprule
  \textbf{Notation} & \textbf{Description} \\
  \midrule
  \endhead
  \label{tab:decorations}%
  $p_{0}$ & equilibrium $p$ \\
  $\delta p$ & perturbation of $p$ \\
  $p_{n}$ & \textsc{Fourier} coefficient of perturbation of $p$ with toroidal mode number $n$ \\
  $p_{m n}$ & \textsc{Fourier} coefficient of perturbation of $p$ with poloidal mode number $m$ and toroidal mode number $n$ \\
  $p^{(k)}$ & $k$-th summand in series expansion of perturbed $p$ / $k$-th degree of freedom of $p$ in a particular loop \\
  $p^{[k]}$ & $k$-th partial sum in series expansion of perturbed $p$ \\
  \midrule
  $\vec{J}^{\pol}$ & poloidal component of $\vec{J}$ \\
  $\vec{J}^{\tor}$ & toroidal component of $\vec{J}$ \\
  $\vec{J}^{\parallel}$ & component of $\vec{J}$ parallel to $\vec{B}_{0}$ \\
  $\vec{J}^{\perp}$ & component of $\vec{J}$ perpendicular to $\vec{B}_{0}$ \\
  $J^{u}$ & contravariant component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $J_{u}$ & covariant component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $J_{(u)}$ & physical component of $\vec{J}$ w.r.t.\ coordinate $u$ \\
  $\hat{\vec{n}}$ & unit vector in direction of $\vec{n}$ \\
  \midrule
  $\vec{B} (\vec{r}^{(k)})$ & $\vec{B}$ evaluated at node with index $k$ \\
  $\vec{B} (\Gamma_{e}^{(k)})$ & $\vec{B}$ evaluated at midpoint of edge $e$ of triangle $k$ \\
  $\vec{B} (\Omega^{(k)})$ & $\vec{B}$ evaluated at weighted centroid of triangle $k$ \\
  \bottomrule
\end{longtable}

\section{Arnoldi iterations}
\label{app:Arnoldi}

For an $N \times N$ matrix $\hat{K}$, the \textsc{Arnoldi} algorithm gives the largest $n_{r}$ \textsc{Ritz} eigenvalues $\lambda_{k}$  and the associated eigenvectors $\vec{v}_{k}$ which span the \textsc{Krylov} subspace of $\hat{K}$. To accomplish this, $\hat{K}$ is repeatedly applied to an arbitrary initial vector $\vec{q}_{1}$. In each iteration step, the next \textsc{Arnoldi} vector $\vec{q}_{k}$ is generated and orthonormalized with respect to the previously generated vectors by \textsc{Gram}-\textsc{Schmidt} orthogonalization. Also, entries of an upper \textsc{Hessenberg} matrix $\hat{H}$ are constructed, as outlined in \cref{alg:arnoldi}.
\begin{algorithm}
  \caption{\textsc{Arnoldi} iterations}
  \label{alg:arnoldi}
  \begin{algorithmic}[1]
    \State{$\vec{q}_{1} \gets \frac{\vec{q}_{1}}{\norm{\vec{q}_{1}}}$}
    \For{$k = 2, 3, \dotsc, n_{r}$}
      \State{$\vec{q}_{k} \gets \hat{K} \vec{q}_{k-1}$}
      \For{$j = 1, 2, \dotsc, k-1$}
        \State{$H_{j, k-1} \gets \vec{q}_{j}^{\dagger} \vec{q}_{k}$}
        \State{$\vec{q}_{k} \gets \vec{q}_{k} - H_{j, k-1} \vec{q}_{j}$}
      \EndFor
      \State{$H_{k, k-1} \gets \norm{\vec{q}_{k}}$}
      \State{$\vec{q}_{k} \gets \frac{\vec{q}_{k}}{H_{k, k-1}}$}
    \EndFor
  \end{algorithmic}
\end{algorithm}
Grouping together the $\vec{q}_{k}$ vectors in an $N \times n_{r}$ matrix $\hat{Q}$, an approximation of $\hat{K}$ can be written out as
\begin{gather}
  \hat{K} \approx \hat{Q} \hat{H} \hat{Q}^{\dagger}.
\end{gather}
Diagonalization of $\hat{H}$ via the LAPACK routine \texttt{zhseqr} yields the \textsc{Ritz} eigenvalues $\lambda_{k}$ and application of $\hat{Q}$ on the eigenvectors of $\hat{H}$ obtained via \texttt{zhsein} gives the eigenvectors $\vec{v}_{k}$ associated with $\hat{K}$.

\section{Fourier series of vector quantitites}

$\Bpert$ in symmetry flux coordinates $(\rho, \theta, \phi)$ is given as the \textsc{Fourier} series
\begin{gather}
  \delta B^{k} (\rho, \theta, \phi) = B_{n}^{k}(\rho, \theta) \e^{\im n \phi}.
\end{gather}
$\Bpert$ is also divergence-free and assuming $g = g(\rho, \theta)$, we get
\begin{align}
  0 &= \sqrt{g} \divg \Bpert = \partial_{k} \left( \sqrt{g} \delta B^{k} \right) = \partial_{k} \left( \sqrt{g} B_{n}^{k} \e^{\im n \phi} \right) = \partial_{k} \left( \mathcal{B}_{n}^{k} \e^{\im n \phi} \right) = \\
    &= \partial_{\rho} \left( \mathcal{B}_{n}^{\rho} \right) \e^{\im n \phi} + \mathcal{B}_{n}^{\phi} \partial_{\phi} \left( \e^{\im n \phi} \right) + \partial_{\theta} \left( \mathcal{B}_{n}^{\theta} \right) \e^{\im n \phi} = \\
    &= \underbrace{\e^{\im n \phi}}_{\neq 0} \left( \partial_{\rho} \mathcal{B}_{n}^{\rho} + \im n \mathcal{B}_{n}^{\phi} + \partial_{\theta} \mathcal{B}_{n}^{\theta} \right).
\end{align}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../magdif"
%%% End: 
